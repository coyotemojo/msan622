group = years,
color = years
)
)
p <- p + geom_line(alpha = 0.8)
p <- p + facet_wrap(~ years, ncol = 4)
p <- p + coord_polar()
p <- p + scale_months()
print(p)
plot(d$total_kill_inj_per_km)
line(d$total_kill_inj_per_km)
lines(d$total_kill_inj_per_km)
print(plotOverview(start = test_start))
plotOverview <- function(start = 1969, num = 12) {
xmin <- start
xmax <- start + (num / 12)
ymin <- 1500
ymax <- 4500
p <- ggplot(d, aes(x = time, y = total_kill_inj))
p <- p + geom_rect(
xmin = xmin, xmax = xmax,
ymin = ymin, ymax = ymax,
fill = grey)
p <- p + geom_line(color='red')
p <- p + scale_x_continuous(
limits = range(melted$time),
expand = c(0, 0),
breaks = seq(1969, 1984, by = 1))
p <- p + scale_y_continuous(
limits = c(ymin, ymax),
expand = c(0, 0),
breaks = seq(ymin, ymax, length.out = 3))
p <- p + theme(panel.border = element_rect(
fill = NA, colour = grey))
p <- p + theme(axis.title = element_blank())
p <- p + theme(panel.grid = element_blank())
p <- p + theme(panel.background = element_blank())
return(p)
}
print(plotOverview(start = test_start))
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
str(d)
summary(d)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
melted
melted[variable == totla_kill_ing]
melted[variable == totla_kill_inj]
melted[variable == total_kill_inj]
head(melted)
melted$variable == total_kill_inj
melted$variable == total_kill_inj
melted$variable == drivers_kill
melted$variable == 'drivers_kill'
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
subset(melted, variable %in% c('drivers_kill_inj',
'front_kill_inj',
'rear_kill_inj'))
subset(melted, variable %in% c('drivers_kill_inj',
'front_kill_inj',
'rear_kill_inj'))
str(melted)
d <- data.frame(
years,
months,
time = as.numeric(times),
drivers_kill = as.numeric(Seatbelts[,'DriversKilled']),
drivers_kill_inj = as.numeric(Seatbelts[,'drivers']),
front_kill_inj = as.numeric(Seatbelts[,'front']),
rear_kill_inj = as.numeric(Seatbelts[,'rear']),
kms = as.numeric(Seatbelts[,'kms']),
petrol_price = as.numeric(Seatbelts[,'PetrolPrice']),
van_kill = as.numeric(Seatbelts[,'VanKilled']),
law = as.factor(Seatbelts[,'law'])
)
d$total_kill_inj <- (d$drivers_kill_inj + d$front_kill_inj + d$rear_kill_inj)
d$total_kill_inj_per_km <- d$total_kill_inj/d$kms
str9d
str(d)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
str(melted)
levels(melted$variables)
levels(melted$variable)
first = 'front_kill_inj'
melted$variable <- relevel(variable, first)
melted$variable <- relevel(melted$variable, first)
print(plotArea(start = test_start))
first = 'drivers_kill_inj'
melted$variable <- relevel(melted$variable, first)
print(plotArea(start = test_start))
first = 'front_kill_inj'
melted$variable <- relevel(melted$variable, first)
print(plotArea(start = test_start))
?order
order(melted, variable)
order(melted, melted$variable)
order(melted by melted$variable)
order(melted, by=melted$variable)
source('~/Documents/msan/classes/data_visualization/msan622/homework3/server.r')
runApp
runApp()
setwd('Documents/msan/classes/data_visualization/msan622/homework5/')
runApp()
setwd('Documents/msan/classes/data_visualization/msan622/homework5/')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server_prev.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
data(Seatbelts)
times <- time(Seatbelts)
years <- floor(times)
years <- factor(years, ordered = TRUE)
months <- factor(
month.abb[cycle(times)],
levels = month.abb,
ordered = TRUE
)
d <- data.frame(
years,
months,
time = as.numeric(times),
drivers_kill = as.numeric(Seatbelts[,'DriversKilled']),
drivers_kill_inj = as.numeric(Seatbelts[,'drivers']),
front_kill_inj = as.numeric(Seatbelts[,'front']),
rear_kill_inj = as.numeric(Seatbelts[,'rear']),
kms = as.numeric(Seatbelts[,'kms']),
petrol_price = as.numeric(Seatbelts[,'PetrolPrice']),
van_kill = as.numeric(Seatbelts[,'VanKilled']),
law = as.numeric(Seatbelts[,'law'])
)
d$total_kill_inj <- (d$drivers_kill_inj + d$front_kill_inj + d$rear_kill_inj)
d$total_kill_inj_per_km <- d$total_kill_inj/d$kms
melted <- melt(d, id = c('years', 'months', 'time'))
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(
x = months,
y = value,
group = years,
color = years
)
)
p <- p + geom_line(alpha = 0.8)
p <- p + facet_wrap(~ years, ncol = 4)
p <- p + coord_polar()
p <- p + scale_months()
print(p)
melted$variable <- relevel(melted$variable, first)
first = 'front_kill_inj'
print(plotOverview(start = test_start))
plot(d$total_kill_inj_per_km)
plot(d$kms)
d$drivers_kill_inj_per_km <- d$drivers_kill_inj/d$kms
d$front_kill_inj_per_km <- d$front_kill_inj/d$kms
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
print(plotOverview(start = test_start))
print(plotArea(start = test_start))
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
str(d)
summary(d)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(
x = months,
y = value,
group = years,
color = years
)
)
p <- p + geom_line(alpha = 0.8)
p <- p + facet_wrap(~ years, ncol = 4)
p <- p + coord_polar()
p <- p + scale_months()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
print(plotArea(start = test_start))
first = 'front_kill_inj'
melted$variable <- relevel(melted$variable, first)
print(plotArea(start = test_start))
first = 'drivers_kill_inj'
melted$variable <- relevel(melted$variable, first)
print(plotArea(start = test_start))
melted(variable)
melted[variable]
melted
head(melted)
melted[variable]
melted[,variable]
melted['variable']
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = month, y = year)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
# p <- p + coord_polar()
p <- p + coord_fixed(ratio = 1)
print(p)
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = year)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
#p <- p + theme_heatmap()
# p <- p + coord_polar()
p <- p + coord_fixed(ratio = 1)
print(p)
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
#p <- p + theme_heatmap()
# p <- p + coord_polar()
p <- p + coord_fixed(ratio = 1)
print(p)
p <- p + coord_flip()
print(p)
theme_heatmap <- function() {
return (
theme(
axis.text.y = element_text(
angle = 90,
hjust = 0.5),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
panel.background = element_blank()
)
)
}
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
#p <- p + theme_heatmap()
p <- p + coord_flip()
p <- p + coord_fixed(ratio = 1)
print(p)
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
print(p)
p <- p + coord_flip()
print(p)
scale_prgn <- function() {
return(
scale_fill_gradientn(
colours = brewer_pal(
type = "div",
palette = "PRGn")(5),
name = "Deaths",
limits = c(0, 4000),
breaks = c(0, 2000, 4000)
)
)
}
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/ui.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
summary(d)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
summary(d)
runApp()
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
scale_prgn <- function() {
return(
scale_fill_gradientn(
colours = brewer_pal(
type = "div",
palette = "PRGn")(5),
name = "Deaths",
)
)
}
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
scale_prgn <- function() {
return(
scale_fill_gradientn(
colours = brewer_pal(
type = "div",
palette = "PRGn")(5),
name = "Deaths",
values = seq(0, .5, length=5)
)
)
}
theme_heatmap <- function() {
return (
theme(
axis.text.y = element_text(
angle = 90,
hjust = 0.5),
axis.ticks = element_blank(),
axis.title = element_blank(),
legend.direction = "horizontal",
legend.position = "bottom",
panel.background = element_blank()
)
)
}
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
scale_prgn <- function() {
return(
scale_fill_gradientn(
colours = brewer_pal(
type = "div",
palette = "PRGn")(5),
name = "Deaths",
values = seq(0, .5, length=10)
)
)
}
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(
aes(fill = value),
colour = "white"
)
p <- p + scale_prgn()
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
p <- ggplot(
subset(melted, variable == "total_kill_inj_per_km"),
aes(x = months, y = years)
)
p <- p + geom_tile(aes(fill = value), colour = "white")
p <- p + scale_fill_gradient(low='white', high='red')
p <- p + scale_months()
p <- p + scale_y_discrete(expand = c(0, 0))
p <- p + theme_heatmap()
p <- p + coord_fixed(ratio = 1)
p <- p + coord_flip()
print(p)
source('~/Documents/msan/classes/data_visualization/msan622/homework5/server.R')
runApp()
source('~/Documents/msan/classes/data_visualization/msan622/homework5/hw5.R')
